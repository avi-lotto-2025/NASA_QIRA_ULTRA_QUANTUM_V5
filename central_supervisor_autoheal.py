# ================================================
# CENTRAL SUPERVISOR & AUTO-HEAL DIRECTOR  V6.1
# ××—×¨××™ ×¢×œ ×”×¤×¢×œ×”, × ×™×˜×•×¨, ×¨×™×¤×•×™-×¢×¦××™, ×•××™×¤×•×¡ ×©×œ
# ×›×œ ×©×›×‘×•×ª ××¢×¨×›×ª NASA_QIRA_ULTRA ×‘×¨×¦×£ ××™× ×¡×•×¤×™.
# ================================================

import os
import time
import threading
import subprocess

# =====================================================
# ×›×œ ×”××•×“×•×œ×™× ×©××¨×›×™×‘×™× ××ª ×”××¢×¨×›×ª â€“ ×‘×œ×™ ×œ×©× ×•×ª ×©××•×ª!
# =====================================================
MODULES = [
    "nasa_qira_ultra_quantum_v5_1_init.py",
    "heartbeat_core_controller.py",
    "autonomic_recovery_system.py",
    "quantum_awareness_layer.py",
    "self_synchronization_memory_layer.py",
    "integration_bridge.py"
]

# =====================================================
# ×¤×•× ×§×¦×™×” ×©××¨×™×¦×” ××•×“×•×œ ×™×—×™×“ ×›-process × ×¤×¨×“
# =====================================================
def run_module(module):
    try:
        return subprocess.Popen(["python3", module])
    except Exception as e:
        print(f"[!] ×©×’×™××” ×‘×”×¨×¦×ª ××•×“×•×œ {module}: {e}")
        return None

# =====================================================
# ×××—×¡×Ÿ ×›×œ ××•×“×•×œ ×›-process ×¤×¢×™×œ
# =====================================================
processes = {}

# =====================================================
# ××¤×¢×™×œ ××—×“×© ××•×“×•×œ ×©× ×¤×œ
# =====================================================
def restart_module(module):
    print(f"\n[â›”] ×”××•×“×•×œ × ×¤×œ: {module}\nâ‡’ ××¤×¢×™×œ ××—×“×©...")
    p = run_module(module)
    if p:
        processes[module] = p
        print(f"[âœ”ï¸] ×”××•×“×•×œ ×¢×œ×” ××—×“×©: {module}\n")
    else:
        print(f"[âŒ] ×›×©×œ ×‘×”×¤×¢×œ×” ××—×“×©: {module}")

# =====================================================
# ×”×¤×¢×œ×ª ×›×œ ×”××•×“×•×œ×™× ×‘×ª×—×™×œ×ª ×”×“×¨×š
# =====================================================
def start_all_modules():
    print("\nğŸš€ ××¤×¢×™×œ ××ª ×›×œ ×©×›×‘×•×ª NASA_QIRA_ULTRA...\n")
    for module in MODULES:
        p = run_module(module)
        if p:
            processes[module] = p
            print(f"[âœ”] ×”×•×¤×¢×œ: {module}")
        else:
            print(f"[âŒ] ×›×©×œ ×‘×”×¤×¢×œ×”: {module}")
    print("\nğŸŸ¢ ×›×œ ×”××•×“×•×œ×™× ×”×•×¢×œ×•. ××ª×—×™×œ × ×™×˜×•×¨...\n")

# =====================================================
# ×œ×•×œ××ª ×”× ×™×˜×•×¨ ×”××™× ×¡×•×¤×™×ª (×”××¢×¨×›×ª NEVER STOPS)
# =====================================================
def supervisor_loop():
    while True:
        time.sleep(10)  # ×›×œ 10 ×©× ×™×•×ª ×‘×•×“×§×™×
        
        for module, process in processes.items():
            if process.poll() is not None:  # ×”×ª×”×œ×™×š ××ª
                restart_module(module)

        print("ğŸ’  ×”××¢×¨×›×ª ×¤×¢×™×œ×” â€” ×›×œ ×”××•×“×•×œ×™× × ×‘×“×§×•â€¦")

# =====================================================
# ×”×¤×¢×œ×ª Thread × ×¤×¨×“ ×©××™× ×• ××¤×¡×™×§ ×œ×¢×•×œ×
# =====================================================
def start_supervisor_thread():
    thread = threading.Thread(target=supervisor_loop)
    thread.daemon = True
    thread.start()
    print("\nğŸ§  ××¢×¨×š ×”× ×™×˜×•×¨ ×”×•×¤×¢×œ âœ”\n")

# =====================================================
# MAIN â€” ××” ×©×§×•×¨×” ×›×©×”×§×•×‘×¥ ×”×–×” ×¨×¥
# =====================================================
if __name__ == "__main__":
    start_all_modules()
    start_supervisor_thread()

    while True:
        time.sleep(60)  # ×”×œ×‘ ×©×œ ×”××¢×¨×›×ª â€“ ×œ×¢×•×œ× ×œ× ××¤×¡×™×§
